<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
            xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
            xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd
   http://www.liquibase.org/xml/ns/dbchangelog
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">


    <changeSet author="asviridova" id="2.0.1" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="GOODS_OBJECT_ID_SEQ"/>
            </not>
        </preConditions>
        <createSequence sequenceName="GOODS_OBJECT_ID_SEQ" incrementBy="1" startValue="1"/>
        <comment>Creation of GOODS_OBJECT_ID_SEQ sequence </comment>
    </changeSet>

    <changeSet author="asviridova" id="2.0.2" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <tableExists tableName="GOODS"/>
                </not>
            </and>
        </preConditions>

        <createTable remarks="Таблица с товарами" tableName="GOODS">
            <column name="ID" type="NUMBER(18,0)" autoIncrement="true" defaultValueSequenceNext="GOODS_OBJECT_ID_SEQ">
                <constraints nullable="false" primaryKey="true" primaryKeyName="GOODS_PK"/>
            </column>
            <column name="CODE" remarks="Код товара" type="VARCHAR(100 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" remarks="Название товара" type="VARCHAR(255 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="COLOUR" remarks="Цвет товара" type="VARCHAR(100 BYTE)"/>
            <column name="SIZE" remarks="Размер товара" type="VARCHAR(20 BYTE)"/>
            <column name="PRICE" remarks="PRICE" type="NUMBER(18,2)">
                <constraints nullable="false"/>
            </column>
            <column name="GOODSTYPEID" remarks="GOODSTYPEID" type="NUMERIC(18,0)">
                <constraints nullable="false"/>
            </column>
            <column name="BRANDID" remarks="BRANDID" type="NUMERIC(18,0)"/>
            <column name="PROVIDERID" remarks="PROVIDERID" type="NUMERIC(18,0)">
                <constraints nullable="false"/>
            </column>
            <column name="STOREID" remarks="STOREID" type="NUMERIC(18,0)"/>
        </createTable>
    </changeSet>

    <changeSet author="asviridova" id="2.0.3" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="GOODSTYPE_OBJECT_ID_SEQ"/>
            </not>
        </preConditions>
        <createSequence sequenceName="GOODSTYPE_OBJECT_ID_SEQ" incrementBy="1" startValue="1"/>
        <comment>Creation of GOODSTYPE_OBJECT_ID_SEQ sequence </comment>
    </changeSet>

    <changeSet author="asviridova" id="2.0.4" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <tableExists tableName="GOODSTYPE"/>
                </not>
            </and>
        </preConditions>

        <createTable remarks="Таблица с типами" tableName="GOODSTYPE">
            <column name="ID" type="NUMBER(18,0)" autoIncrement="true" defaultValueSequenceNext="GOODSTYPE_OBJECT_ID_SEQ">
                <constraints nullable="false" primaryKey="true" primaryKeyName="GOODS_TYPE_PK"/>
            </column>
            <column name="CODE" remarks="Код" type="VARCHAR(100 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" remarks="Название" type="VARCHAR(255 BYTE)"/>
        </createTable>
    </changeSet>

    <changeSet author="asviridova" id="2.0.5" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="BRAND_OBJECT_ID_SEQ"/>
            </not>
        </preConditions>
        <createSequence sequenceName="BRAND_OBJECT_ID_SEQ" incrementBy="1" startValue="1"/>
        <comment>Creation of BRAND_OBJECT_ID_SEQ sequence </comment>
    </changeSet>

    <changeSet author="asviridova" id="2.0.6" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <tableExists tableName="BRAND"/>
                </not>
            </and>
        </preConditions>

        <createTable remarks="Таблица с брендами" tableName="BRAND">
            <column name="ID" type="NUMBER(18,0)" autoIncrement="true" defaultValueSequenceNext="BRAND_OBJECT_ID_SEQ">
                <constraints nullable="false" primaryKey="true" primaryKeyName="BRAND_TYPE_PK"/>
            </column>
            <column name="NAME" remarks="Название" type="VARCHAR(100 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="COUNTRY" remarks="Страна" type="VARCHAR(255 BYTE)"/>
        </createTable>
    </changeSet>

    <changeSet author="asviridova" id="2.0.7" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="STORE_OBJECT_ID_SEQ"/>
            </not>
        </preConditions>
        <createSequence sequenceName="STORE_OBJECT_ID_SEQ" incrementBy="1" startValue="1"/>
        <comment>Creation of STORE_OBJECT_ID_SEQ sequence </comment>
    </changeSet>

    <changeSet author="asviridova" id="2.0.8" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <tableExists tableName="STORE"/>
                </not>
            </and>
        </preConditions>

        <createTable remarks="Склады" tableName="STORE">
            <column name="ID" type="NUMBER(18,0)" autoIncrement="true" defaultValueSequenceNext="STORE_OBJECT_ID_SEQ">
                <constraints nullable="false" primaryKey="true" primaryKeyName="STORE_TYPE_PK"/>
            </column>
            <column name="CODE" remarks="Код" type="VARCHAR(100 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="ADDRESS" remarks="Адрес" type="VARCHAR(255 BYTE)"/>
        </createTable>
    </changeSet>

    <changeSet author="asviridova" id="2.0.9" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="PROVIDER_OBJECT_ID_SEQ"/>
            </not>
        </preConditions>
        <createSequence sequenceName="PROVIDER_OBJECT_ID_SEQ" incrementBy="1" startValue="1"/>
        <comment>Creation of PROVIDER_OBJECT_ID_SEQ sequence </comment>
    </changeSet>

    <changeSet author="asviridova" id="2.0.10" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <tableExists tableName="PROVIDER"/>
                </not>
            </and>
        </preConditions>

        <createTable remarks="Поставщик" tableName="PROVIDER">
            <column name="ID" type="NUMBER(18,0)" autoIncrement="true" defaultValueSequenceNext="PROVIDER_OBJECT_ID_SEQ">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PROVIDER_TYPE_PK"/>
            </column>
            <column name="NAME" remarks="Название" type="VARCHAR(100 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="INN" remarks="ИНН" type="VARCHAR(255 BYTE)"/>
            <column name="ADDRESS" remarks="ИНН" type="VARCHAR(255 BYTE)"/>
            <column name="FLAGBLACKLIST" remarks="Входит в черный список" type="NUMBER(1)"/>
        </createTable>
    </changeSet>


    <changeSet author="asviridova" id="2.0.11" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <not>
                <sequenceExists sequenceName="CUSTOMER_OBJECT_ID_SEQ"/>
            </not>
        </preConditions>
        <createSequence sequenceName="CUSTOMER_OBJECT_ID_SEQ" incrementBy="1" startValue="1"/>
        <comment>Creation of CUSTOMER_OBJECT_ID_SEQ sequence </comment>
    </changeSet>

    <changeSet author="asviridova" id="2.0.12" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <tableExists tableName="CUSTOMER"/>
                </not>
            </and>
        </preConditions>

        <createTable remarks="Клиент" tableName="CUSTOMER">
            <column name="ID" type="NUMBER(18,0)" autoIncrement="true" defaultValueSequenceNext="CUSTOMER_OBJECT_ID_SEQ">
                <constraints nullable="false" primaryKey="true" primaryKeyName="CUSTOMER_TYPE_PK"/>
            </column>
            <column name="LOGIN" remarks="LOGIN" type="VARCHAR(100 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" remarks="ФИО" type="VARCHAR(255 BYTE)">
                <constraints nullable="false"/>
            </column>
            <column name="PHONE" remarks="PHONE" type="VARCHAR(40 BYTE)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>


    <changeSet author="asviridova" id="2.0.13" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <foreignKeyConstraintExists foreignKeyName="GOODS_GOODSTYPEID_FK1"/>
                </not>
            </and>
        </preConditions>
        <addForeignKeyConstraint baseColumnNames="GOODSTYPEID" baseTableName="GOODS"
                                 constraintName="GOODS_GOODSTYPEID_FK1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT"
                                 referencedColumnNames="ID" referencedTableName="GOODSTYPE" referencesUniqueColumn="false" />
    </changeSet>

    <changeSet author="asviridova" id="2.0.14" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <foreignKeyConstraintExists foreignKeyName="GOODS_PROVIDERID_FK1"/>
                </not>
            </and>
        </preConditions>
        <addForeignKeyConstraint baseColumnNames="PROVIDERID" baseTableName="GOODS"
                                 constraintName="GOODS_PROVIDERID_FK1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT"
                                 referencedColumnNames="ID" referencedTableName="PROVIDER" referencesUniqueColumn="false" />
    </changeSet>

    <changeSet author="asviridova" id="2.0.15" runInTransaction="false">
        <preConditions onFail="MARK_RAN">
            <and>
                <not>
                    <foreignKeyConstraintExists foreignKeyName="GOODS_STOREID_FK1"/>
                </not>
            </and>
        </preConditions>
        <addForeignKeyConstraint baseColumnNames="STOREID" baseTableName="GOODS"
                                 constraintName="GOODS_STOREID_FK1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT"
                                 referencedColumnNames="ID" referencedTableName="STORE" referencesUniqueColumn="false" />
    </changeSet>

    <!--changeSet author="asviridova" id="2.0.13" runInTransaction="false">
        <addForeignKeyConstraint baseColumnNames="GOODSTYPEID" baseTableName="GOODS"
                                 constraintName="GOODS_GOODSTYPEID_FK1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT"
                                 referencedColumnNames="ID" referencedTableName="GOODSTYPE" referencesUniqueColumn="false" />
    </changeSet>

    <changeSet author="asviridova" id="2.0.14" runInTransaction="false">
        <addForeignKeyConstraint baseColumnNames="PROVIDERID" baseTableName="GOODS"
                                 constraintName="GOODS_PROVIDERID_FK1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT"
                                 referencedColumnNames="ID" referencedTableName="PROVIDER" referencesUniqueColumn="false" />
    </changeSet>

    <changeSet author="asviridova" id="2.0.15" runInTransaction="false">
        <addForeignKeyConstraint baseColumnNames="STOREID" baseTableName="GOODS"
                                 constraintName="GOODS_STOREID_FK1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT"
                                 referencedColumnNames="ID" referencedTableName="STORE" referencesUniqueColumn="false" />
    </changeSet-->



</databaseChangeLog>